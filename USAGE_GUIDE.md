# 富邦銀行薪資轉帳系統 - 完整使用指南

## 🚀 快速開始

### 需要準備什麼
1. **CSV 檔案**: 員工薪資資料（格式參考下方示例）
2. **委託單位代號**: 向富邦銀行分行取得的 7 碼代號
3. **Node.js**: 已安裝在系統上

### 使用步驟（推薦方式）

#### 步驟 1: 準備 CSV 檔案
CSV 檔案需要包含以下欄位：
```
NO,姓名,月薪,身分證號,出生年月日,銀行,帳號,代碼,應付薪資
1,王小明,"34,000",A123456789,1990/12/16,台北富邦銀行,1234-5678-9012,012-3604,"34,000"
2,李小華,"50,000",B234567890,1995/06/20,台北富邦銀行,2345-6789-0123,012-3604,"50,000"
...
```

**重點**:
- `NO` 欄位: 員工序號（1, 2, 3...）
- `姓名`: 員工姓名
- `應付薪資`: 實際進帳薪資（數字，可有逗號）
- `身分證號`: 員工身份證號
- `帳號`: 銀行帳號

#### 步驟 2: 設定委託單位代號
編輯 `generate_salary_file.js` 檔案，找到這一行：
```javascript
let UNIT_CODE = '0000000'; // 委託單位代號（7 碼，需自行設定）
```
改成你從富邦銀行取得的 7 碼代號。

#### 步驟 3: 執行腳本
在終端機中進入專案目錄並執行：
```bash
node generate_salary_file.js --code 你的代號
```

或者使用自訂 CSV 檔案路徑：
```bash
node generate_salary_file.js --csv ./path/to/your/file.csv --code 你的代號
```

#### 步驟 4: 檢查結果
腳本會：
- ✅ 顯示找到的員工數量
- ✅ 列出所有員工和薪資
- ✅ 生成 txt 檔案到桌面
- ✅ 顯示檔案位置

#### 步驟 5: 上傳到富邦系統
1. 前往富邦銀行薪資轉帳系統
2. 上傳生成的 txt 檔案
3. 完成！

---

## 📋 CSV 檔案格式詳解

| 欄位 | 說明 | 範例 | 必填 |
|------|------|------|------|
| NO | 員工序號 | 1, 2, 3 | ✅ |
| 姓名 | 員工全名 | 王小明 | ✅ |
| 月薪 | 基本月薪 | 34,000 | - |
| 身分證號 | 員工身份證 | A123456789 | ✅ |
| 出生年月日 | 出生日期 | 1990/12/16 | - |
| 銀行 | 銀行名稱 | 台北富邦銀行 | - |
| 帳號 | 銀行帳號 | 1234-5678-9012 | ✅ |
| 代碼 | 代碼 | 012-3604 | - |
| 應付薪資 | **實際進帳薪資（重要!）** | 34,000 | ✅ |

**注意**: 系統使用 `應付薪資` 欄位（不是 `月薪`），這通常會因扣款或加班而不同。

---

## 🔧 進階用法

### 修改 CSV 檔案路徑
如果你的 CSV 檔案不在桌面，編輯這一行：
```javascript
let CSV_FILE = './here.csv';
```

改成你的檔案路徑。

### 修改輸出目錄
改這一行：
```javascript
let OUTPUT_DIR = './';
```

### 查看生成的 txt 檔案內容
執行完後，你可以用文字編輯器打開生成的 txt 檔案。格式如下：

```
K123456700000************11412100000068000000
C123456700000001234567890120000000000003400000A123456789
C123456700000002345678901230000000000005000000B234567890
...
```

- **K** 開頭: 批次檔頭（包含委託單位代號、發薪日期、薪資總額）
- **C** 開頭: 員工記錄（包含帳號、薪資、身份證號）

---

## ⚠️ 常見問題

### Q: 腳本顯示 "找到 0 位員工"
**A:** CSV 檔案格式有問題。檢查：
- NO 欄位是否有數字 (1, 2, 3...)
- 是否有 "合計" 行（會被自動排除）
- CSV 編碼是否為 UTF-8

### Q: 薪資數字不對
**A:** 確認 CSV 檔案中使用的是 `應付薪資` 欄位，不是 `月薪`

### Q: 身份證號顯示不對
**A:** 腳本會自動轉為大寫並補空白，這是正常的

### Q: 帳號被移除了一些字符
**A:** 腳本會自動移除帳號中的非數字字元（只保留數字），這是富邦系統的要求

---

## 📅 每月使用流程

1. **更新 CSV 檔案** - 將最新的薪資資料輸入到 CSV
2. **執行腳本** - `node generate_salary_file.js`
3. **驗證結果** - 檢查員工數和薪資總額
4. **上傳到富邦** - 上傳生成的 txt 檔案

---

## 🔒 資安提示

✅ **安全的做法**:
- 保管好你的 CSV 檔案
- 不要分享包含薪資資料的檔案
- txt 檔案上傳後可以刪除

❌ **不要做的事**:
- 將 CSV 檔案放在雲端
- 分享 txt 檔案給其他人
- 在公共電腦上執行

---

## 📞 需要幫助？

如果遇到問題，請準備以下資訊聯絡：
1. CSV 檔案的前幾行（注意隱藏敏感資訊）
2. 執行腳本時的錯誤訊息
3. 委託單位代號（確認是 7 碼）
